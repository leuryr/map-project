var Model=[{name:"Yankee Stadium",geometry:{location:{lat:40.829622,lng:-73.926173}},typeEnabled:ko.observable(!0),types:["stadium"],vicinity:"1 E 161st St, Bronx"},{name:"The Bronx Museum of the Arts",geometry:{location:{lat:40.831011,lng:-73.919719}},typeEnabled:ko.observable(!0),types:["museum"],vicinity:"1040 Grand Concourse, Bronx"},{name:"Concourse Plaza",geometry:{location:{lat:40.825227,lng:-73.920491}},typeEnabled:ko.observable(!0),types:["shopping_mall"],vicinity:"220 E 161st St, Bronx"},{name:"Bronx County Family Court",geometry:{location:{lat:40.826746,lng:-73.920696}},typeEnabled:ko.observable(!0),types:["courthouse"],vicinity:"900 Sheridan Ave, Bronx"},{name:"Bronx County Hall of Justice",geometry:{location:{lat:40.826102,lng:-73.919612}},typeEnabled:ko.observable(!0),types:["courthouse"],vicinity:"265 E 161st St, Bronx"},{name:"Bronx Supreme Court",geometry:{location:{lat:40.826173,lng:-73.923834}},typeEnabled:ko.observable(!0),types:["courthouse"],vicinity:"851 Grand Concourse #111, Bronx"},{name:"Heritage Field",geometry:{location:{lat:40.827023,lng:-73.927761}},typeEnabled:ko.observable(!0),types:["park"],vicinity:", Bronx"},{name:"Joseph Yancey Track and Field",geometry:{location:{lat:40.828025,lng:-73.929016}},typeEnabled:ko.observable(!0),types:["park"],vicinity:", Bronx"},{name:"Joyce Kilmer Park",geometry:{location:{lat:40.828522,lng:-73.922673}},typeEnabled:ko.observable(!0),types:["park"],vicinity:"Walton Ave, Bronx"},{name:"Mullaly Park",geometry:{location:{lat:40.833092,lng:-73.924046}},typeEnabled:ko.observable(!0),types:["park"],vicinity:"Jerome Ave, Bronx"}],initApp=function(){map=new google.maps.Map(document.getElementById("map"),{center:Model[8].geometry.location,zoom:16,mapTypeControl:!1}),ko.applyBindings(new ViewModel)},mapFail=function(){console.log("Maps did not load!")},ViewModel=function(){var self=this;self.locations=ko.observableArray(Model),self.selectedValue=ko.observable(),self.selectedValue.subscribe(function(newValue){console.log(newValue),self.locations().forEach(function(item){item.types.includes(newValue)||"Choose a type"==newValue?(item.typeEnabled(!0),item.marker.setVisible(!0)):(item.typeEnabled(!1),item.marker.setVisible(!1),infoWindowService.close())})}),self.resetFilter=function(){self.selectedValue("Choose a type")};var infoWindowService=new google.maps.InfoWindow;self.fillInfoWindow=function(location,infoWindow){if(infoWindow.marker!=location.marker){infoWindow.marker=location.marker;var address=location.vicinity,firstLine=address.substring(0,address.indexOf(","));infoWindow.setContent("<div>"+location.name+"<hr><br>"+firstLine+"<br>Bronx, NY</div>"),infoWindow.open(map,location.marker)}},self.createMarkers=function(array){array().forEach(function(item){if(!item.hasOwnProperty("marker")){var position=item.geometry.location,title=item.name,marker=new google.maps.Marker({position:position,title:title,map:map,animation:google.maps.Animation.DROP});marker.addListener("click",function(){self.animateMarker(this),self.fillInfoWindow(item,infoWindowService)}),item.marker=marker}})},self.createMarkers(self.locations),self.initType=function(item){item.typeEnabled=ko.observable(!0)};var places=new google.maps.places.PlacesService(map),searchRequest={location:Model[8].geometry.location,radius:500,types:["bank","bar","gym","movie_theater","restaurant"]},requestCallback=function(results,status){status==google.maps.places.PlacesServiceStatus.OK?(console.log(results),results.forEach(function(result){self.initType(result),self.locations.push(result)}),self.createMarkers(self.locations)):console.log("Could not complete search!")};places.nearbySearch(searchRequest,requestCallback),self.getMarker=function(object){var marker=object.marker;self.animateMarker(marker)},self.getInfoWindow=function(object){self.fillInfoWindow(object,infoWindowService)},self.animateMarker=function(marker){marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){marker.setAnimation(null)},2150)};var listContainer=$(".list-container"),menuIcon=$(".menu-icon");self.toggleMenu=function(){listContainer.toggleClass("open-menu"),menuIcon.toggleClass("slide-icon")}};